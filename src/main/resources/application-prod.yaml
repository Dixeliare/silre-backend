# Production Profile Configuration
# Usage: java -jar app.jar --spring.profiles.active=prod
# Or set: SPRING_PROFILES_ACTIVE=prod
#
# ⚠️ IMPORTANT: In production, these values should come from:
# - Environment Variables (recommended)
# - Kubernetes ConfigMaps/Secrets
# - Spring Cloud Config Server
# - HashiCorp Vault
#
# NEVER commit production credentials to Git!

spring:
  # Redis Configuration (Production - High Availability)
  data:
    redis:
      # Use Redis Cluster or Sentinel for HA
      # Option 1: Redis Cluster
      # cluster:
      #   nodes:
      #     - redis-cluster-1:6379
      #     - redis-cluster-2:6379
      #     - redis-cluster-3:6379
      #   max-redirects: 3
      
      # Option 2: Redis Sentinel (Recommended for HA)
      # sentinel:
      #   master: mymaster
      #   nodes:
      #     - redis-sentinel-1:26379
      #     - redis-sentinel-2:26379
      #     - redis-sentinel-3:26379
      
      # Option 3: Single Redis (with password) - Fallback
      host: ${REDIS_HOST:redis.production.internal}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD}  # From environment variable
      timeout: 3000ms
      ssl:
        enabled: ${REDIS_SSL_ENABLED:false}  # Enable SSL in production
      lettuce:
        pool:
          max-active: 32      # Higher pool for production
          max-idle: 16
          min-idle: 8
          max-wait: 2000ms
        shutdown-timeout: 100ms

# TSID Configuration - Production (Redis REQUIRED)
tsid:
  allow-dev-mode: false  # ⚠️ MUST be false in production

# Actuator - More endpoints exposed in production
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus  # Add metrics for monitoring
  endpoint:
    health:
      show-details: when-authorized
  metrics:
    export:
      prometheus:
        enabled: true  # Enable Prometheus metrics

# Logging - Less verbose, structured logging
logging:
  level:
    root: WARN
    com.longdx.silre_backend: INFO
    org.springframework: WARN
  pattern:
    # Structured JSON logging for log aggregation (ELK, Splunk, etc.)
    # console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
    # For JSON: Use logback-json-classic dependency

# Database Connection Pool (Production tuning)
spring:
  datasource:
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
